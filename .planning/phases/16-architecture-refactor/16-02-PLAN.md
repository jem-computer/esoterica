---
phase: 16-architecture-refactor
plan: 02
type: execute
wave: 2
depends_on: ["16-01"]
files_modified:
  - skills/tarot/SKILL.md
autonomous: true

must_haves:
  truths:
    - "SKILL.md contains card index with all 78 card entries"
    - "Full card meanings removed from SKILL.md"
    - "SKILL.md instructs Claude to read card files after drawing"
    - "Existing wizard and voice system unchanged"
  artifacts:
    - path: "skills/tarot/SKILL.md"
      provides: "Orchestration layer with card index"
      contains: "## Card Index"
    - path: "skills/tarot/SKILL.md"
      provides: "Loading instructions"
      contains: "cards/major-arcana.md"
  key_links:
    - from: "skills/tarot/SKILL.md"
      to: "cards/major-arcana.md"
      via: "Explicit Read instruction after card draw"
      pattern: "Read.*cards/major-arcana\\.md"
    - from: "Card Index table"
      to: "Card Matching Functions"
      via: "Card number lookup"
      pattern: "\\| 0 \\| The Fool"
---

<objective>
Transform SKILL.md into a lean orchestration layer by replacing full card meanings with a compact card index and explicit loading instructions.

Purpose: Enable lazy loading of card data - Claude loads full meanings only after cards are drawn.
Output: Refactored SKILL.md with card index, loading instructions, and no embedded card meanings.
</objective>

<execution_context>
@/Users/jem/.claude/get-shit-done/workflows/execute-plan.md
@/Users/jem/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/16-architecture-refactor/16-RESEARCH.md
@.planning/phases/16-architecture-refactor/16-01-SUMMARY.md
@skills/tarot/SKILL.md
@skills/tarot/cards/major-arcana.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add card index and loading instructions to SKILL.md</name>
  <files>skills/tarot/SKILL.md</files>
  <action>
Add two new sections to SKILL.md, placed AFTER "Card Matching Functions" section and BEFORE the "## Major Arcana Meanings" section (which will be removed in Task 2).

**Section 1: Card Index**

Insert a compact lookup table with all 78 cards (22 Major + 56 Minor placeholders):

```markdown
## Card Index

Use this index to identify drawn cards. After drawing, read the appropriate card file for full meanings.

| # | Name | Suit | Keywords |
|---|------|------|----------|
| 0 | The Fool | Major | New beginnings, leap of faith, innocence, potential |
| 1 | The Magician | Major | Manifestation, skill, tools, channeling power |
| 2 | The High Priestess | Major | Intuition, mystery, hidden knowledge, receptivity |
| 3 | The Empress | Major | Abundance, nurturing, creativity, growth |
| 4 | The Emperor | Major | Structure, authority, leadership, boundaries |
| 5 | The Hierophant | Major | Tradition, teaching, spiritual authority, mentorship |
| 6 | The Lovers | Major | Choice, union, values, relationship |
| 7 | The Chariot | Major | Willpower, determination, victory, control |
| 8 | Strength | Major | Inner strength, compassion, gentle mastery, courage |
| 9 | The Hermit | Major | Solitude, inner guidance, wisdom, introspection |
| 10 | Wheel of Fortune | Major | Cycles, fate, change, turning points |
| 11 | Justice | Major | Fairness, truth, consequence, balance |
| 12 | The Hanged Man | Major | Surrender, new perspective, pause, sacrifice |
| 13 | Death | Major | Transformation, endings, release, transition |
| 14 | Temperance | Major | Balance, moderation, alchemy, patience |
| 15 | The Devil | Major | Bondage, materialism, shadow work, attachment |
| 16 | The Tower | Major | Sudden upheaval, revelation, liberation, crisis |
| 17 | The Star | Major | Hope, inspiration, healing, renewal |
| 18 | The Moon | Major | Illusion, intuition, fear, unconscious |
| 19 | The Sun | Major | Joy, clarity, vitality, success |
| 20 | Judgement | Major | Awakening, reckoning, resurrection, calling |
| 21 | The World | Major | Completion, integration, accomplishment, wholeness |
```

Note: Minor Arcana entries (22-77) will be added in Phase 17. For now, include only Major Arcana (0-21).

**Section 2: Card Data Files**

Add loading instructions immediately after the Card Index:

```markdown
## Card Data Files

Card meanings are stored in separate files by suit. After drawing cards, read ONLY the relevant file(s).

**Available card files:**
- [Major Arcana](cards/major-arcana.md) - The Fool through The World (0-21)
- [Wands](cards/wands.md) - Ace through King of Wands (Phase 17)
- [Cups](cards/cups.md) - Ace through King of Cups (Phase 17)
- [Swords](cards/swords.md) - Ace through King of Swords (Phase 17)
- [Pentacles](cards/pentacles.md) - Ace through King of Pentacles (Phase 17)

**Loading pattern:**

After cards are drawn (digital mode) or entered (physical mode):

1. **Identify the drawn card(s)** by matching to the Card Index above
2. **Determine suit file(s) needed** based on suit column
3. **Read only the needed file(s)** - do not load all card files
4. **Find the specific card section** (e.g., "## Card 16: The Tower")
5. **Proceed with interpretation** using the card's Themes, Situations, Shadows, Symbols

Example: For a single card draw of The Tower (16), read `cards/major-arcana.md` and locate "## Card 16: The Tower".
```

Place these sections in SKILL.md between "Card Matching Functions" and "Major Arcana Meanings" (lines ~250-380).
  </action>
  <verify>
- SKILL.md contains "## Card Index" section
- Card Index table has 22 rows (Major Arcana only for Phase 16)
- SKILL.md contains "## Card Data Files" section
- Loading instructions reference cards/major-arcana.md
- `grep -c "cards/major-arcana.md" skills/tarot/SKILL.md` returns at least 1
  </verify>
  <done>
- Card Index section with all 22 Major Arcana entries
- Card Data Files section with explicit loading instructions
- Relative paths to all five card files documented
  </done>
</task>

<task type="auto">
  <name>Task 2: Remove full card meanings from SKILL.md</name>
  <files>skills/tarot/SKILL.md</files>
  <action>
Remove the entire "## Major Arcana Meanings" section from SKILL.md. This content now lives in cards/major-arcana.md.

The section to remove spans from "## Major Arcana Meanings" (around line 381) through the end of Card 21: The World (around line 513) - approximately 130 lines of card definitions.

**What to keep:**
- All content before Card Index (wizard, spread logic, card matching, physical mode)
- The new Card Index section (added in Task 1)
- The new Card Data Files section (added in Task 1)
- All content after card meanings (Voice System, Voice Examples, Voice Consistency, Reading Instructions)

**What to remove:**
- The entire "## Major Arcana Meanings" section including:
  - ### Card 0: The Fool through ### Card 21: The World
  - All Themes/Situations/Shadows/Symbols for each card

After removal, SKILL.md should flow:
1. Wizard section
2. Spread Selection Logic
3. Card Matching Functions
4. Physical Mode Card Entry
5. Mode Dispatch
6. Reading Context
7. **Card Index** (NEW)
8. **Card Data Files** (NEW)
9. Voice System
10. Voice Examples
11. Multi-Card Voice Examples
12. Voice Consistency
13. Reading Instructions

Expected line count reduction: ~130 lines (from ~843 to ~713 lines, plus ~40 new lines for index/instructions = ~753 total).

Also update the SKILL MAINTAINER NOTES comment block at the top to change:
- "Embedded card data for portability (no external files)"
to:
- "Card data in cards/ directory (lazy loaded after draw)"

And update "Last updated" to "Phase 16 - Architecture Refactor".
  </action>
  <verify>
- "## Major Arcana Meanings" no longer appears in SKILL.md
- `grep -c "### Card 0: The Fool" skills/tarot/SKILL.md` returns 0
- `grep -c "Themes:" skills/tarot/SKILL.md` returns 0 (no card meaning content)
- SKILL.md still contains Voice System, Reading Instructions
- SKILL.md line count is approximately 700-800 lines (reduced from ~843)
- Maintainer notes updated
  </verify>
  <done>
- Full card meanings removed from SKILL.md
- SKILL.md is now a lean orchestration layer
- All wizard, voice, and interpretation logic preserved
- Maintainer notes updated to reflect new architecture
  </done>
</task>

</tasks>

<verification>
After both tasks complete:

1. **Lazy loading works:** SKILL.md instructs Claude to Read card files after drawing
2. **Card index complete:** 22 Major Arcana entries in Card Index table
3. **Full meanings removed:** No "### Card N:" sections in SKILL.md
4. **Orchestration preserved:** Voice System, Reading Instructions intact
5. **Functional test:** Mentally trace a reading:
   - Wizard collects question/spread/mode
   - Cards drawn via shuf
   - Card Index identifies drawn cards
   - Claude reads cards/major-arcana.md
   - Locates specific card section
   - Interprets using Themes/Situations/Shadows/Symbols
   - Voice System applies throughout
</verification>

<success_criteria>
- [ ] SKILL.md contains Card Index with 22 Major Arcana entries
- [ ] SKILL.md contains Card Data Files section with loading instructions
- [ ] No "## Major Arcana Meanings" or embedded card meanings in SKILL.md
- [ ] Voice System and Reading Instructions unchanged
- [ ] SKILL.md line count reduced by ~100+ lines
- [ ] Maintainer notes updated to "Phase 16 - Architecture Refactor"
</success_criteria>

<output>
After completion, create `.planning/phases/16-architecture-refactor/16-02-SUMMARY.md`
</output>
